{"version":3,"sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"names":["Dragger","Upload","Result","styled","div","H1","h1","Img","img","Uploader","observer","useStores","ImageStore","UserStore","ref1","useRef","ref2","props","showUploadList","beforeUpload","file","setFile","setFilename","name","currentUser","message","warning","window","test","type","size","error","upload","then","serverFile","success","catch","store","useLocalStore","width","setWidth","value","height","setHeight","attributes","url","widthStr","heightStr","tip","spinning","isUploading","className","InboxOutlined","href","target","rel","filename","src","alt","Item","label","defaultValue","onChange","ref","fullStr","AlertWrapper","Component","children","description","showIcon","Home","Tips"],"mappings":"mjBAOOA,EAAWC,IAAXD,QAEDE,EAASC,IAAOC,IAAV,KAMNC,EAAKF,IAAOG,GAAV,KAKFC,EAAMJ,IAAOK,IAAV,KAsHMC,EAjHEC,aAAS,WAAO,IAAD,EACEC,cAAzBC,EADuB,EACvBA,WAAYC,EADW,EACXA,UACbC,EAAOC,mBACPC,EAAOD,mBAEPE,EAAQ,CACZC,gBAAgB,EAChBC,aAAc,SAAAC,GAGZ,OAFAR,EAAWS,QAAQD,GACnBR,EAAWU,YAAYF,EAAKG,MACE,OAA1BV,EAAUW,aACZC,IAAQC,QAAQ,qDACT,IAGTC,OAAOP,KAAOA,EAET,wCAAwCQ,KAAKR,EAAKS,MAInDT,EAAKU,KAAO,SACdL,IAAQM,MAAM,gCACP,IAITnB,EAAWoB,SACRC,MAAK,SAACC,GACLT,IAAQU,QAAQ,+BACfC,OAAM,SAACL,GACVN,IAAQM,MAAM,gCAET,IAfLN,IAAQM,MAAM,mFACP,MAiBPM,EAAQC,aAAc,iBAAO,CACjCC,MAAO,KACPC,SAFiC,SAExBC,GACPJ,EAAME,MAAQE,GAEhB,eACE,OAAOJ,EAAME,MAAN,aAAoBF,EAAME,OAAU,IAG7CG,OAAQ,KACRC,UAViC,SAUvBF,GACRJ,EAAMK,OAASD,GAEjB,gBACE,OAAOJ,EAAMK,OAAN,aAAqBL,EAAMK,QAAW,IAG/C,cACE,OAAO9B,EAAWsB,WAAWU,WAAWC,IAAID,WAAWC,IAAM,gBAAkBR,EAAMS,SAAWT,EAAMU,eAa1G,OACE,6BACE,kBAAC,IAAD,CAAMC,IAAI,qBAAOC,SAAUrC,EAAWsC,aACpC,kBAAClD,EAAYiB,EACX,uBAAGkC,UAAU,wBACX,kBAACC,EAAA,EAAD,OAEF,uBAAGD,UAAU,mBAAb,wFACA,uBAAGA,UAAU,mBAAb,0HAMHvC,EAAWsB,WAAa,oCACvB,kBAAChC,EAAD,KACE,kBAACG,EAAD,iCACA,4BACE,wDACA,4BAAI,uBAAGgD,KAAMzC,EAAWsB,WAAWU,WAAWC,IAAID,WAAWC,IACtDS,OAAO,SAASC,IAAI,uBAAuB3C,EAAWsB,WAAWU,WAAWC,IAAID,WAAWC,MAElG,kDACA,4BAAKjC,EAAW4C,UAChB,wDACA,4BAAI,kBAACjD,EAAD,CAAKkD,IAAK7C,EAAWsB,WAAWU,WAAWC,IAAID,WAAWC,IAAKa,IAAI,8BACvE,wDACA,kBAAC,IAAD,KACE,kBAAC,IAAKC,KAAN,CAAWC,MAAM,oDACf,kBAAC,IAAD,CAAaC,aAAc,EAAGC,SArCpB,SAACrB,GACvBJ,EAAMG,SAASC,IAoCsDsB,IAAKjD,KAEhE,kBAAC,IAAK6C,KAAN,CAAWC,MAAM,oDACf,kBAAC,IAAD,CAAaC,aAAc,EAAGC,SApCnB,SAACrB,GACxBJ,EAAMM,UAAUF,IAmCsDsB,IAAK/C,MAGnE,4BAAI,uBAAGqC,KAAMhB,EAAM2B,QAASV,OAAO,SAASC,IAAI,uBAAuBlB,EAAM2B,aAK7E,S,mGC7HZ,IAAMC,EAAe9D,IAAOC,IAAV,KAeH8D,EAXGxD,aAAS,YAAiB,IAAfyD,EAAc,EAAdA,SACpBtD,EAAaF,cAAbE,UACP,OACE,oCAEIA,EAAUW,YAAc,KAAO,kBAACyC,EAAD,KAAc,kBAAC,IAAD,CAAOxC,QAAQ,eAAK2C,YAAaD,EAAUtC,KAAK,UAAUwC,UAAQ,SCXjHC,EAAO5D,aAAS,WAEpB,OACE,oCACE,kBAAC6D,EAAD,qEACA,kBAAC,EAAD,UAKSD","file":"static/js/11.9499e152.chunk.js","sourcesContent":["import React, {useRef} from 'react'\nimport {observer, useLocalStore} from 'mobx-react'\nimport {useStores} from '../stores'\nimport {InboxOutlined} from '@ant-design/icons'\nimport {Upload, message, InputNumber, Form,Spin} from 'antd'\nimport styled from 'styled-components'\n\nconst {Dragger} = Upload\n\nconst Result = styled.div`\n  border: 1px dashed #ccc;\n  margin-top: 30px;\n  padding: 20px;\n`\n\nconst H1 = styled.h1`\n  margin: 20px 0;\n  text-align: center;\n`\n\nconst Img = styled.img`\n  max-width: 300px;\n`\n\n\nconst Uploader = observer(() => {\n  const {ImageStore, UserStore} = useStores()\n  const ref1 = useRef()\n  const ref2 = useRef()\n\n  const props = {\n    showUploadList: false,\n    beforeUpload: file => {\n      ImageStore.setFile(file)\n      ImageStore.setFilename(file.name)\n      if (UserStore.currentUser === null) {\n        message.warning('请先登录再上传！')\n        return false\n      }\n\n      window.file = file\n\n      if (!/(svg$)|(png$)|(jpg$)|(jpeg$)|(gif$)/ig.test(file.type)) {\n        message.error('只能上传 png / jpg / jpeg / gif 格式的图片')\n        return false\n      }\n      if (file.size > 1024 * 1024) {\n        message.error('图片最大 1M')\n        return false\n      }\n\n\n      ImageStore.upload()\n        .then((serverFile) => {\n          message.success('上传成功')\n        }).catch((error) => {\n        message.error('上传失败')\n      })\n      return false\n    }\n  }\n  const store = useLocalStore(() => ({\n    width: null,\n    setWidth(value) {\n      store.width = value\n    },\n    get widthStr() {\n      return store.width ? `/w/${store.width}` : ''\n    },\n\n    height: null,\n    setHeight(value) {\n      store.height = value\n    },\n    get heightStr() {\n      return store.height ? `/h/${store.height}` : ''\n    },\n\n    get fullStr() {\n      return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.widthStr + store.heightStr\n    }\n\n  }))\n\n  const bindWidthChange = (value) => {\n    store.setWidth(value)\n  }\n\n  const bindHeightChange = (value) => {\n    store.setHeight(value)\n  }\n\n  return (\n    <div>\n      <Spin tip=\"上传中\"  spinning={ImageStore.isUploading}>\n        <Dragger {...props}>\n          <p className=\"ant-upload-drag-icon\">\n            <InboxOutlined/>\n          </p>\n          <p className=\"ant-upload-text\">单击或拖动文件到该区域以上传</p>\n          <p className=\"ant-upload-hint\">\n            仅支持 .png / .jpg / .jpeg / .gif / .svg 格式的图片，图片最大 1M\n          </p>\n        </Dragger>\n      </Spin>\n\n      {ImageStore.serverFile ? <>\n        <Result>\n          <H1>上传结果</H1>\n          <dl>\n            <dt>线上地址</dt>\n            <dd><a href={ImageStore.serverFile.attributes.url.attributes.url}\n                   target=\"_blank\" rel=\"noopener noreferrer\">{ImageStore.serverFile.attributes.url.attributes.url}</a>\n            </dd>\n            <dt>文件名</dt>\n            <dd>{ImageStore.filename}</dd>\n            <dt>图片预览</dt>\n            <dd><Img src={ImageStore.serverFile.attributes.url.attributes.url} alt=\"图片预览\"/></dd>\n            <dt>更多尺寸</dt>\n            <Form>\n              <Form.Item label=\"最大宽度（可选）\">\n                <InputNumber defaultValue={0} onChange={bindWidthChange} ref={ref1}/>\n              </Form.Item>\n              <Form.Item label=\"最大高度（可选）\">\n                <InputNumber defaultValue={0} onChange={bindHeightChange} ref={ref2}/>\n              </Form.Item>\n            </Form>\n            <dd><a href={store.fullStr} target=\"_blank\" rel=\"noopener noreferrer\">{store.fullStr}</a></dd>\n          </dl>\n\n        </Result>\n\n      </> : null}\n\n    </div>\n  )\n})\n\nexport default Uploader\n","import React from 'react'\r\nimport {useStores} from '../stores'\r\nimport {observer} from 'mobx-react'\r\nimport {Alert} from 'antd'\r\nimport styled from 'styled-components'\r\n\r\n\r\nconst AlertWrapper = styled.div`\r\n  margin: 30px 0;\r\n`\r\n\r\nconst Component = observer(({children}) => {\r\n  const {UserStore} = useStores()\r\n  return (\r\n    <>\r\n      {\r\n        UserStore.currentUser ? null : <AlertWrapper><Alert message=\"警告\" description={children} type=\"warning\" showIcon/></AlertWrapper>\r\n      }\r\n    </>\r\n  )\r\n})\r\n\r\nexport default Component\r\n","import React from 'react'\r\nimport {observer} from 'mobx-react'\r\nimport Uploader from '../components/Uploader'\r\nimport Tips from '../components/Tips'\r\n\r\nconst Home = observer(() => {\r\n\r\n  return (\r\n    <>\r\n      <Tips>请先登录再上传！！！</Tips>\r\n      <Uploader/>\r\n    </>\r\n  )\r\n})\r\n\r\nexport default Home"],"sourceRoot":""}